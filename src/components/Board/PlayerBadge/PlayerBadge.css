@import "tailwindcss";

/* Root container for the badge */
.player-badge {
  /* Extra vertical separation to avoid overlay shadow overlap */
  @apply flex flex-col items-center gap-3;
}

/* Name plate displayed above the avatar */
/* Modern name plate with edge transparency */
.player-name-box {
  @apply font-medium leading-none px-4 py-2;
  background: 
    linear-gradient(
      90deg,
      transparent 0%,
      var(--name-bg, rgba(255, 255, 255, 0.95)) 15%,
      var(--name-bg, rgba(255, 255, 255, 0.95)) 85%,
      transparent 100%
    ),
    radial-gradient(
      circle at 50% 50%,
      rgba(255, 255, 255, 0.4) 0%,
      transparent 70%
    );
  
  font-family: "Metropolis";
  font-weight: 200;
  color: #1a1a1a;
  
  position: relative;
  z-index: 10;
  top: 2px;

  transition: all 0.2s ease-in-out;

  /* --- Correct text shadows --- */
  text-shadow:
    0 1px 2px rgba(0, 0, 0, 0.25),   /* subtle depth */
    0 2px 4px rgba(0, 0, 0, 0.15),   /* diffuse softness */
    0 0 6px rgba(78, 26, 21, 0.481); /* your warm glow tone (#f4e1a3) */
}


/* ===== Avatar + overlays stack ===== */
.avatar-stack {
  position: relative; /* Absolute overlays will anchor here */
  display: inline-block;
}

/* Circular avatar with colored ring and thin black inner/outer edges */
.avatar-circle {
  @apply rounded-full overflow-hidden bg-slate-300 grid place-items-center w-full h-full;
  position: relative;
  z-index: 0;

  /* Ring color is set inline via style={{ ["--tw-ring-color"]: ringCol }} */
  --tw-ring-color: rgb(51 65 85 / 0.7);

  /* Ring thickness */
  --ring-width: 5px;

  /* Subtle colored glow (fallback values) */
  --ring-glow-blur: 30px;
  --ring-glow-spread: 15px;

  /* Thin black inner edge between the image and the ring */
  border: 1px solid #000;

  /* Fallback glow: uses the same ring color directly (no alpha).
     We'll override below with color-mix() when supported. */
  box-shadow:
    /* colored ring */ 0 0 0 var(--ring-width) var(--tw-ring-color),
    /* outer black edge */ 0 0 0 calc(var(--ring-width) + 1px) #000,
    /* subtle colored glow (fallback) */ 0 0 var(--ring-glow-blur)
      var(--ring-glow-spread) var(--tw-ring-color),
    /* soft shadows */ 0 10px 15px -3px rgb(0 0 0 / 0.1),
    0 4px 6px -4px rgb(0 0 0 / 0.1);
}

/* Prefer a softer glow using color-mix() when available */
@supports (color: color-mix(in oklab, #000 50%, transparent)) {
  .avatar-circle {
    /* Derive a semi-transparent glow from the ring color */
    --ring-glow: color-mix(in oklab, var(--tw-ring-color) 55%, transparent);

    box-shadow:
      /* colored ring */ 0 0 0 var(--ring-width)
        var(--tw-ring-color),
      /* outer black edge */ 0 0 0 calc(var(--ring-width) + 1px) #000,
      /* refined colored glow */ 0 0 var(--ring-glow-blur)
        var(--ring-glow-spread) var(--ring-glow),
      /* soft shadows */ 0 10px 15px -3px rgb(0 0 0 / 0.1),
      0 4px 6px -4px rgb(0 0 0 / 0.1);
  }
}

/* Remove glow/ambient shadows when the ring is gray */
.avatar-circle.no-glow {
  /* Keep the colored ring and the thin black outer edge only */
  box-shadow: 0 0 0 var(--ring-width) var(--tw-ring-color),
    0 0 0 calc(var(--ring-width) + 1px) #000;
}

@supports (color: color-mix(in oklab, #000 50%, transparent)) {
  /* Ensure the override also wins in browsers that support color-mix */
  .avatar-circle.no-glow {
    box-shadow: 0 0 0 var(--ring-width) var(--tw-ring-color),
      0 0 0 calc(var(--ring-width) + 1px) #000;
  }
}

/* Sizes applied to .avatar-stack wrapper */
.badge-small {
  @apply w-28 h-28 text-lg;
} /* 112x112 */
.badge-big {
  @apply w-38 h-38 text-lg;
} /* 152x152 */

/* Avatar image fills the circle */
.avatar-img {
  @apply w-full h-full object-cover;
}

/* Placeholder style (when no image source is provided) */
.avatar-placeholder {
  @apply select-none;
  color: rgb(51 65 85 / 0.8);
}

/* ===== Overlays controlled by CSS variables ===== */
/* CardCount overlay */
.badge-cardcount {
  position: absolute;
  left: var(--cc-left, auto);
  right: var(--cc-right, auto);
  top: var(--cc-top, auto);
  bottom: var(--cc-bottom, auto);
  pointer-events: none;
}

/* ViewSecrets overlay */
.badge-secrets {
  position: absolute;
  left: var(--sec-left, auto);
  right: var(--sec-right, auto);
  top: var(--sec-top, auto);
  bottom: var(--sec-bottom, auto);
  pointer-events: auto;
  z-index: 2; /* Above sets by default */
}

/* SetsGrid overlay */
.badge-sets {
  position: absolute;
  pointer-events: auto;
  z-index: 1;

  /* anchor edge only */
  top: 0;       /* or bottom: 0; depending on position */
  left: 100%;   /* right of avatar, for position-right */
  
  /* remove width/height: let content size naturally */
  width: max-content;
  height: max-content;

  /* optional small gap */
  margin-left: 16px;  /* spacing from avatar */
}

/* ===== POSITION PRESETS (hardcoded offsets) =====
   Tune the pixel values to match your layout needs.
*/
/* ----- SMALL (112x112) ----- */
.avatar-stack.badge-small.position-right {
  /* CardCount: bottom-right (slightly outside) */
  --cc-right: 20px;
  --cc-bottom: -75px;

  /* Secrets: top-right */
  --sec-right: -73px;
  --sec-top: -70px;

  /* SetsGrid: to the right side of the avatar */
  --sets-left: 100%;      /* anchor to right edge */
  --sets-top: 0;
  --sets-transform: translateX(16px);
}

.avatar-stack.badge-small.position-left {
  /* CardCount: bottom-left */
  --cc-left: 40px;
  --cc-bottom: -72px;

  /* Secrets: top-left */
  --sec-left: -73px;
  --sec-top: -70px;

  /* SetsGrid: to the left side of the avatar */
  --sets-right: 100%;     /* anchor to left edge */
  --sets-top: 0;
  --sets-transform: translateX(-16px);
}

.avatar-stack.badge-small.position-up {
  /* CardCount: centered above (approx) */
  --cc-left: 125px;
  --cc-top: 25px;

  /* Secrets: top-right to avoid overlap */
  --sec-right: 135px;
  --sec-top: -70px;

  /* SetsGrid: above the avatar (left-aligned) */
  --sets-left: 50%;       /* center horizontally */
  --sets-bottom: 100%;
  --sets-transform: translateX(-50%) translateY(-16px);
}

/* ----- BIG (152x152) ----- */
.avatar-stack.badge-big.position-down {
  /* SetsGrid: below the avatar */
  --sets-left: 50%;       /* center horizontally */
  --sets-top: 100%;
  --sets-transform: translateX(-50%) translateY(16px);
}

.avatar-stack.position-right .badge-sets {
  top: -30%;
  left: -100%;
  margin-left: 16px;
}

.avatar-stack.position-left .badge-sets {
  top: -30%;
  left: 100%;
  margin-right: 16px;
}

.avatar-stack.position-up .badge-sets {
  top: 100%;
  left: 40%;
  transform: translateX(-50%);
  margin-bottom: 16px;
}

.avatar-stack.position-down .badge-sets {
  top: -90%;
  left: 450%;
  transform: translateX(-50%);
  margin-top: 16px;
}

/* ===== Social Disgrace Styles =====
/* Grayscale the avatar image when disgraced */
.avatar-circle.is-disgraced .avatar-img {
  filter: grayscale(1) brightness(0.98) contrast(0.85);
  transition: filter 200ms ease-in-out;
}

.player-name-box.is-disgraced {
  /* Keep original base styles and add a subtle pattern */
  opacity: 0.6;
  color: #f4f1b4;
  background-image: repeating-linear-gradient(
    45deg,
    rgba(255, 205, 139, 0.24) 0 4px,
    transparent 4px 8px
  );
}
